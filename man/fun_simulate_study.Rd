% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fun_simulate_study.r
\name{fun_simulate_study}
\alias{fun_simulate_study}
\title{Simulate a Three-Period Crossover Study and Analyze Treatment Effects}
\usage{
fun_simulate_study(
  n_samp = 18,
  block_size_coef = 1,
  total_variance = 2,
  ICC = 0.75,
  treat_eff_c = c(3, 2, 1),
  missing_prop = c(0.05, 0.1)
)
}
\arguments{
\item{n_samp}{Integer. Total number of subjects to simulate (default is 18).}

\item{block_size_coef}{Numeric. Coefficient to determine block size; block size is calculated as \code{6 * block_size_coef} (default is 1).}

\item{total_variance}{Numeric. Total variance of the outcome variable (default is 2).}

\item{ICC}{Numeric between 0 and 1. Intraclass Correlation Coefficient, representing the proportion of variance due to random effects (default is 0.75).}

\item{treat_eff_c}{Numeric vector of length 3. Treatment effects for treatments A, B, and C, respectively (default is \code{c(3, 2, 1)}).}

\item{missing_prop}{Numeric vector of length 2. Cumulative proportions of missing data in periods 2 and 3 (default is \code{c(0.05, 0.1)}).}
}
\value{
An \code{emmGrid} object containing contrasts of estimated marginal means (EMMs) for the treatments, including estimates, standard errors, degrees of freedom, t-ratios, and p-values.
}
\description{
Simulates data for a three-period crossover study with three treatments (A, B, C) using a Williams design.
The function generates subject-level random effects and residual errors based on specified variance components,
introduces missing data according to specified proportions, fits a linear mixed-effects model,
and computes contrasts of treatment effects.
}
\details{
The function performs the following steps:
\enumerate{
\item Generates a Williams design sequence for three treatments over three periods.
\item Simulates subject-level random intercepts based on the specified \code{ICC} and \code{total_variance}.
\item Assigns subjects to sequences using block randomization via \code{\link{fun_block_randomize}}.
\item Simulates outcome data (\code{y}) for each subject in each period, incorporating treatment effects, random effects, and residual errors.
\item Introduces missing data in periods 2 and 3 according to \code{missing_prop}.
\item Fits a linear mixed-effects model (\code{lmerTest::lmer}) with fixed effects for period and treatment, and a random intercept for subject.
\item Computes contrasts of treatment effects using \code{emmeans::contrast} without adjustment.
}

The contrasts calculated compare:
\itemize{
\item Treatment C vs. Treatment A (\code{"C vs A"})
\item Treatment B vs. Treatment A (\code{"B vs A"})
\item Treatment C vs. Treatment B (\code{"C vs B"})
}

If the model fitting fails (e.g., due to insufficient data), the function returns a data frame with nonsensical p-values (\code{p.value = c(2, 2, 2)}) to indicate the failure.
}
\examples{
# Simulate a study with default parameters
result <- fun_simulate_study()
print(result)

# Access the summary of contrasts
summary(result)

# Simulate a study with custom parameters
result <- fun_simulate_study(
  n_samp = 30,
  block_size_coef = 1.5,
  total_variance = 5,
  ICC = 0.5,
  treat_eff_c = c(4, 2, 0),
  missing_prop = c(0.1, 0.2)
)
print(result)

}
\seealso{
\code{\link{fun_block_randomize}}, \code{\link[lmerTest]{lmer}}, \code{\link[emmeans]{emmeans}}
}
